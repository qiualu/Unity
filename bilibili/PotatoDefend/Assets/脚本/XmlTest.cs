using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class XmlTest : MonoBehaviour
{
    // Start is called before the first frame update
    void Start()
    {
        
    }

    // Update is called once per frame
    void Update()
    {
        
    }
}


//public class 防御塔 : MonoBehaviour
//{
//    public GameObject 子弹预制体;
//    public Transform 发射点;

//    private void 发射()
//    {
//        // 从对象池获取子弹
//        GameObject 子弹 = 对象池管理器.实例.获取对象(子弹预制体, 发射点.position, 发射点.rotation);

//        // 设置子弹属性
//        子弹.GetComponent<子弹>().初始化(目标);
//    }
//}

//public class 子弹 : MonoBehaviour
//{
//    private Transform 目标;
//    private float 速度 = 10f;

//    public void 初始化(Transform 目标)
//    {
//        this.目标 = 目标;
//    }

//    private void Update()
//    {
//        if (目标 == null)
//        {
//            回收();
//            return;
//        }

//        // 移动逻辑...

//        if (检测到碰撞())
//        {
//            造成伤害();
//            回收();
//        }
//    }

//    private void 回收()
//    {
//        对象池管理器.实例.回收对象(gameObject);
//    }
//}


//已点击地板位置:
//宽 = 1, 高 = 3   // 石头
//宽 = 1, 高 = 4   // 大花
//宽 = 3, 高 = 3   // 宝箱
//宽 = 3, 高 = 5   // 石头
//宽 = 4, 高 = 6   // 小花
//宽 = 6, 高 = 3   // 石头
//宽 = 6, 高 = 1   // 宝箱
//宽 = 10, 高 = 5  // 石头
//宽 = 11, 高 = 8  // 小花
//宽 = 12, 高 = 3  // 小花
/*

< 路径 >

    < !--中心偏移 0.04 - 0.45-- >

    < 路径点 w = "2" h = "2" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "2" h = "3" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "2" h = "4" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "2" h = "5" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "2" h = "6" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />


    < 路径点 w = "3" h = "6" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "4" h = "6" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "5" h = "6" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />


    < 路径点 w = "5" h = "5" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "5" h = "4" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />


    < 路径点 w = "6" h = "4" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "7" h = "4" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "8" h = "4" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "9" h = "4" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />


    < 路径点 w = "9" h = "5" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "9" h = "6" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />



    < 路径点 w = "10" h = "6" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "11" h = "6" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />


    < 路径点 w = "11" h = "5" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "11" h = "4" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "11" h = "3" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "11" h = "2" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />



    < 路径点 w = "10" h = "2" 名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "9" h = "2"  名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "8" h = "2"  名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "7" h = "2"  名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "6" h = "2"  名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />

    < 路径点 w = "5" h = "2"  名字 = "路" 血量 = "2" 类型 = "外" 价值 = "0" />


    < !--更多路径点... -->

</ 路径 >




	
	<基座位置>
		<!-- 中心偏移 0.04  -0.45   -->
		<!-- 以下是所有宽高对应的路径点，w对应宽，h对应高 -->
		<路径点 w="1" h="1" 名字="路径点_1" 血量="2" 类型="外" 价值="0" />
		<路径点 w="2" h="1" 名字="路径点_2" 血量="2" 类型="外" 价值="0" />
		<路径点 w="3" h="1" 名字="路径点_3" 血量="2" 类型="外" 价值="0" />
		<路径点 w="4" h="1" 名字="路径点_4" 血量="2" 类型="外" 价值="0" />
		<路径点 w="5" h="1" 名字="路径点_5" 血量="2" 类型="外" 价值="0" />
		<路径点 w="6" h="1" 名字="路径点_6" 血量="2" 类型="外" 价值="0" />
		<路径点 w="7" h="1" 名字="路径点_7" 血量="2" 类型="外" 价值="0" />
		<路径点 w="8" h="1" 名字="路径点_8" 血量="2" 类型="外" 价值="0" />
		<路径点 w="9" h="1" 名字="路径点_9" 血量="2" 类型="外" 价值="0" />
		<路径点 w="10" h="1" 名字="路径点_10" 血量="2" 类型="外" 价值="0" />
		<路径点 w="12" h="3" 名字="路径点_11" 血量="2" 类型="外" 价值="0" />
		<路径点 w="12" h="4" 名字="路径点_12" 血量="2" 类型="外" 价值="0" />
		<路径点 w="12" h="5" 名字="路径点_13" 血量="2" 类型="外" 价值="0" />
		<路径点 w="12" h="6" 名字="路径点_14" 血量="2" 类型="外" 价值="0" />
		<路径点 w="11" h="7" 名字="路径点_15" 血量="2" 类型="外" 价值="0" />
		<路径点 w="12" h="7" 名字="路径点_16" 血量="2" 类型="外" 价值="0" />
		<路径点 w="10" h="7" 名字="路径点_17" 血量="2" 类型="外" 价值="0" />
		<路径点 w="9" h="7" 名字="路径点_18" 血量="2" 类型="外" 价值="0" />
		<路径点 w="8" h="7" 名字="路径点_19" 血量="2" 类型="外" 价值="0" />
		<路径点 w="7" h="7" 名字="路径点_20" 血量="2" 类型="外" 价值="0" />
		<路径点 w="8" h="8" 名字="路径点_21" 血量="2" 类型="外" 价值="0" />
		<路径点 w="7" h="8" 名字="路径点_22" 血量="2" 类型="外" 价值="0" />
		<路径点 w="6" h="8" 名字="路径点_23" 血量="2" 类型="外" 价值="0" />
		<路径点 w="6" h="7" 名字="路径点_24" 血量="2" 类型="外" 价值="0" />
		<路径点 w="5" h="7" 名字="路径点_25" 血量="2" 类型="外" 价值="0" />
		<路径点 w="5" h="8" 名字="路径点_26" 血量="2" 类型="外" 价值="0" />
		<路径点 w="4" h="8" 名字="路径点_27" 血量="2" 类型="外" 价值="0" />
		<路径点 w="4" h="7" 名字="路径点_28" 血量="2" 类型="外" 价值="0" />
		<路径点 w="3" h="7" 名字="路径点_29" 血量="2" 类型="外" 价值="0" />
		<路径点 w="3" h="8" 名字="路径点_30" 血量="2" 类型="外" 价值="0" />
		<路径点 w="1" h="7" 名字="路径点_31" 血量="2" 类型="外" 价值="0" />
		<路径点 w="1" h="6" 名字="路径点_32" 血量="2" 类型="外" 价值="0" />
		<路径点 w="1" h="5" 名字="路径点_33" 血量="2" 类型="外" 价值="0" />
		<路径点 w="1" h="4" 名字="路径点_34" 血量="2" 类型="外" 价值="0" />
		<路径点 w="1" h="3" 名字="路径点_35" 血量="2" 类型="外" 价值="0" />
		<路径点 w="1" h="2" 名字="路径点_36" 血量="2" 类型="外" 价值="0" />
		<路径点 w="0" h="2" 名字="路径点_37" 血量="2" 类型="外" 价值="0" />
		<路径点 w="0" h="4" 名字="路径点_38" 血量="2" 类型="外" 价值="0" />
		<路径点 w="6" h="2" 名字="路径点_39" 血量="2" 类型="外" 价值="0" />
		<路径点 w="7" h="2" 名字="路径点_40" 血量="2" 类型="外" 价值="0" />
		<路径点 w="8" h="2" 名字="路径点_41" 血量="2" 类型="外" 价值="0" />
		<路径点 w="8" h="3" 名字="路径点_42" 血量="2" 类型="外" 价值="0" />
		<路径点 w="7" h="3" 名字="路径点_43" 血量="2" 类型="外" 价值="0" />
		<路径点 w="6" h="3" 名字="路径点_44" 血量="2" 类型="外" 价值="0" />
		<路径点 w="10" h="3" 名字="路径点_45" 血量="2" 类型="外" 价值="0" />
		<路径点 w="10" h="4" 名字="路径点_46" 血量="2" 类型="外" 价值="0" />
		<路径点 w="10" h="5" 名字="路径点_47" 血量="2" 类型="外" 价值="0" />
		<路径点 w="9" h="5" 名字="路径点_48" 血量="2" 类型="外" 价值="0" />
		<路径点 w="8" h="5" 名字="路径点_49" 血量="2" 类型="外" 价值="0" />
		<路径点 w="7" h="5" 名字="路径点_50" 血量="2" 类型="外" 价值="0" />
		<路径点 w="6" h="5" 名字="路径点_51" 血量="2" 类型="外" 价值="0" />
		<路径点 w="5" h="5" 名字="路径点_52" 血量="2" 类型="外" 价值="0" />
		<路径点 w="4" h="5" 名字="路径点_53" 血量="2" 类型="外" 价值="0" />
		<路径点 w="4" h="6" 名字="路径点_54" 血量="2" 类型="外" 价值="0" />
		<路径点 w="3" h="6" 名字="路径点_55" 血量="2" 类型="外" 价值="0" />
		<路径点 w="3" h="5" 名字="路径点_56" 血量="2" 类型="外" 价值="0" />
		<路径点 w="3" h="4" 名字="路径点_57" 血量="2" 类型="外" 价值="0" />
		<路径点 w="3" h="3" 名字="路径点_58" 血量="2" 类型="外" 价值="0" />
		<路径点 w="4" h="3" 名字="路径点_59" 血量="2" 类型="外" 价值="0" />
		<路径点 w="4" h="4" 名字="路径点_60" 血量="2" 类型="外" 价值="0" />
	</基座位置>



using System.Collections;
using System.Collections.Generic;
using UnityEngine;

//public class 地板鼠标交互类 : MonoBehaviour
//using UnityEngine;
//using System.Collections;

public class 地板鼠标交互类 : MonoBehaviour
{

 

    // 原始缩放比例（初始状态）
    private Vector3 原始缩放;
    // 悬停时的目标缩放倍数
    public float 悬停缩放 = 1.2f;
    // 点击时的目标缩放倍数
    public float 点击缩放 = 1.5f;
    // 缩放过渡速度（数值越大越快）
    public float 过渡速度 = 10f;

    private bool 正在悬停 = false;
    private bool 正在点击 = false;
    private Coroutine 缩放协程;

    public int 地板id = -1;

    // 关卡加载类的引用，用于记录点击位置
    private 关卡加载类 关卡加载器;
    // 记录当前地板在网格中的位置
    public Vector2Int 网格坐标;

    private void Awake()
    {
        // 记录初始缩放（确保地板预制体初始缩放正确）
        原始缩放 = transform.localScale;
    }

    // 鼠标进入地板范围时
    private void OnMouseEnter()
    {
        正在悬停 = true;
        // 计算目标缩放（原始缩放 * 悬停倍数），传递Vector3类型
        开始缩放协程(原始缩放 * 悬停缩放);
    }

    // 鼠标离开地板范围时
    private void OnMouseExit()
    {
        正在悬停 = false;
        if (!正在点击)
        {
            // 恢复原始缩放
            开始缩放协程(原始缩放);
        }
    }

    // 鼠标按下时
    private void OnMouseDown()
    {
        正在点击 = true;
        // 立即设置为点击缩放（无过渡）
        transform.localScale = 原始缩放 * 点击缩放;
        原始缩放 = 原始缩放 * 1.5f;
        关卡加载类.关卡加载实例.记录点击位置(this);
    }

    // 鼠标松开时
    private void OnMouseUp()
    {
        正在点击 = false;
        if (正在悬停)
        {
            // 若仍在悬停，过渡到悬停缩放
            开始缩放协程(原始缩放 * 悬停缩放);
        }
        else
        {
            // 若已离开，恢复原始缩放
            开始缩放协程(原始缩放);
        }
    }

    // 启动缩放协程（参数改为Vector3目标缩放）
    private void 开始缩放协程(Vector3 目标缩放)
    {
        // 停止当前协程（避免多个过渡冲突）
        if (缩放协程 != null)
        {
            StopCoroutine(缩放协程);
        }
        // 启动新协程，传递Vector3目标
        缩放协程 = StartCoroutine(平滑缩放至目标(目标缩放));
    }

    // 平滑缩放的协程（接收Vector3目标缩放）
    private IEnumerator 平滑缩放至目标(Vector3 目标缩放)
    {
        // 逐步过渡到目标缩放
        while (Vector3.Distance(transform.localScale, 目标缩放) > 0.01f)
        {
            // 每帧插值缩放
            transform.localScale = Vector3.Lerp(
                transform.localScale,
                目标缩放,
                过渡速度 * Time.deltaTime
            );
            yield return null; // 等待下一帧
        }
        // 最终精确设置目标缩放
        transform.localScale = 目标缩放;
    }

    // 从对象池激活时重置状态
    private void OnEnable()
    {
        transform.localScale = 原始缩放;
        正在悬停 = false;
        正在点击 = false;
        if (缩放协程 != null)
        {
            StopCoroutine(缩放协程);
        }
    }
}







*/


